/** * 分页管理 * pageInfo对象：{pageSum:xx, pageParamName:xx, pageUrl:xx, ajaxDiv:xx, isAsyn:xx, formId:xx} * pageSum 页码总数 * pageParamName url中页码参数名 *  * 下面的参数只有在异步翻页时需提供 * pageUrl 页面url(异步翻页时必需) * ajaxDiv 异步翻页刷新的div id(异步翻页时必需) * isAsyn  是否异步（异步翻页为true,未设置或者为false则为非异步翻页） *  * formId 如果翻页时有参数通过form提交则传入formId */var __current_pageindex = 1; // 异步翻页记录当前页var PageManager = function(pageInfo){	var content = '';	var paramName = pageInfo.pageParamName || 'page';	var isAsyn = pageInfo.isAsyn == undefined ? false : pageInfo.isAsyn;	var currentPage = isAsyn ? __current_pageindex : parseInt(getUrlParam(paramName));	var pageSum = pageInfo.pageSum || 0;	var pageUrl = isAsyn ?  pageInfo.pageUrl : window.location.href;	currentPage = isNaN(currentPage) ? 1 : currentPage;	if(currentPage != 1){		content += '<a id="prev_page" href="javascript:;"><img src="images/switch_left.png">上一页</a>';	}	if(pageSum <= 5){		for(var i = 1; i <= pageSum; i++){			if(i == currentPage){				content += '<a style="background-color: #FFEEE5; border: 1px solid #FF5500;color: #FF5500;font-weight: 700;">'+i+'</a>';			}else{				content += '<a class="pagaindex" href="javascript:;">'+i+'</a>';			}		}	}else{ 		if(currentPage <= 3){			for(var j = 1; j <= 5; j++){				if(j == currentPage){					content += '<a style="background-color: #FFEEE5; border: 1px solid #FF5500;color: #FF5500;font-weight: 700;">'+j+'</a>';				}else{					content += '<a class="pagaindex" href="javascript:;">'+j+'</a>';				}			}		}else{			var startIndex = (currentPage-2) > pageSum-4 ?  pageSum-4 : (currentPage-2);			var endIndex = (currentPage+2) > pageSum ?  pageSum : (currentPage+2); 			for(var j = startIndex; j <= endIndex; j++){				if(j == currentPage){					content += '<a style="background-color: #FFEEE5; border: 1px solid #FF5500;color: #FF5500;font-weight: 700;">'+j+'</a>';				}else{					content += '<a class="pagaindex" href="javascript:;">'+j+'</a>';				}			}		}		if(currentPage+2 < pageSum){			content += '<span> ... </span>';		}	}	if(currentPage != pageSum && pageSum!=0){		content += '<a id="next_page" href="javascript:;">下一页<img src="images/switch_right.png"></a>';	}	content += '<span>&nbsp;共'+pageSum+'页&nbsp;&nbsp;到第&nbsp;'+        '<input id="page_num_input" class="pageNO" type="text" maxlength="3" style="width:25px;"/>&nbsp;页</span>'+        '<button id="go_page" style="background:url(images/fenye_btn.png) no-repeat; border: 0 none;height: 22px;line-height: 22px;text-align: center;width: 34px;cursor ointer;margin-left: 5px;">确定</button>'	$(".pages").html(content);		$(".pages .pagaindex").click(function(){		currentPage = $(this).text();		__current_pageindex = isAsyn ? currentPage : __current_pageindex;		goPage(paramName, currentPage);	});		$("#prev_page").click(function(){		currentPage = isAsyn ? --__current_pageindex : parseInt(getUrlParam(paramName))-1;		goPage(paramName, currentPage);	});	$("#next_page").click(function(){		currentPage = isAsyn ? ++__current_pageindex : parseInt(getUrlParam(paramName))+1;		currentPage = isNaN(currentPage) ? 2 : currentPage;		goPage(paramName, currentPage);	});		$("#go_page").click(function(){		currentPage = $("#page_num_input").val();		if(currentPage > pageSum || currentPage < 1){			alert("查询的页码不存在");			return false;		}		__current_pageindex = isAsyn ? currentPage : __current_pageindex;		goPage(paramName, currentPage);	});		function goPage(paramName,pageIndex){		var goUrl = setUrlParam(pageUrl,paramName,pageIndex);		if(isAsyn){			if(pageInfo.formId){ // 若翻页时需要通过form提交数据				var $form = $("#"+pageInfo.formId);				pageUrl = $form.attr("action");				goUrl = setUrlParam(pageUrl,paramName,pageIndex);				$form.attr("action",goUrl);				$form.ajaxSubmit(function(data){					$("#"+pageInfo.ajaxDiv).html(data);				});			}else{				$.get(goUrl,function(data){					$("#"+pageInfo.ajaxDiv).html(data);				});			}		}else{			if(pageInfo.formId){ // 若翻页时需要通过form提交数据				var $form = $("#"+pageInfo.formId);				$form.attr("action",goUrl);				$form.submit();			}else{				location.href = goUrl;			}		}	}};  var getUrlParam = function(name, defVal, url) {	return (RegExp('(^|\\?|&|#)' + name + '=([^&|^#]*)').exec(			url || location.href) || [ , , undefined == defVal ? '' : defVal ])[2];};/** * 设置（修改）url中参数值 *  * @param url 要修改的url * @param paramName 参数名称 * @param paramValue 参数值 * @return */function setUrlParam(url, paramName, paramValue){	var pattern = paramName+'=([^&]*)';	var replaceText = paramName+'='+paramValue;	if (url.match(pattern)){		var tmp = '/\\'+paramName+'=[^&]*/';		tmp = url.replace(eval(tmp), replaceText);		return tmp;	}else{		if (url.match('[\?]')){			return url+'&'+ replaceText;		}else{			return url+'?'+replaceText;		}	}	return '';}