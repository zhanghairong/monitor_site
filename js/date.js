var __months = new Array('January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December');
var __days = new Array('Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday');
	
Date.prototype.format=function(format,useUTC,timezoneOffset) { 
	if(useUTC==undefined){useUTC=false;}
	var value = this.getTime();
	if (useUTC) {
		var mydate = new Date(value + ((timezoneOffset != undefined) ? (timezoneOffset * 60000) : 0));
		var eFullYear = mydate.getUTCFullYear();
		var eYear = '' + mydate.getUTCFullYear();
		eYear = eYear.substr(eYear.length - 2, 2);
		var eLongMonth = __months[mydate.getUTCMonth()];
		var eShortMonth = __months[mydate.getUTCMonth()].substr(0, 3);
		var eFullMonth = '0' + (mydate.getUTCMonth() + 1);
		eFullMonth = eFullMonth.substr(eFullMonth.length - 2, 2);
		var eMonth = mydate.getUTCMonth() + 1;
		var eLongDay = __days[mydate.getUTCDay()];
		var eShortDay = __days[mydate.getUTCDay()].substr(0, 3);
		var eFullDate = '0' + mydate.getUTCDate();
		eFullDate = eFullDate.substr(eFullDate.length - 2, 2);
		var eDate = mydate.getUTCDate();
		var eFullMilHours = '0' + mydate.getUTCHours();
		eFullMilHours = eFullMilHours.substr(eFullMilHours.length - 2, 2);
		var eMilHours = mydate.getUTCHours();
		var eHours = mydate.getUTCHours();
		if (eHours > 12) eHours = eHours - 12;
		var eFullHours = '0' + eHours;
		eFullHours = eFullHours.substr(eFullHours.length - 2, 2);
		var eFullMinutes = '0' + mydate.getUTCMinutes();
		eFullMinutes = eFullMinutes.substr(eFullMinutes.length - 2, 2);
		var eMinutes = mydate.getUTCMinutes();
		var eFullSeconds = '0' + mydate.getUTCSeconds();
		eFullSeconds = eFullSeconds.substr(eFullSeconds.length - 2, 2);
		var eSeconds = mydate.getUTCSeconds();
		var eTripleMSecs = '00' + mydate.getUTCMilliseconds();
		eTripleMSecs = eTripleMSecs.substr(eTripleMSecs.length - 3, 3);
		var eDoubleMSecs = '0' + mydate.getUTCMilliseconds();
		eDoubleMSecs = eDoubleMSecs.substr(eDoubleMSecs.length - 2, 2);
		var eSingleMSecs = mydate.getUTCMilliseconds();
		var eFullBigAMPM = ((mydate.getUTCHours() > 11) ? 'PM': 'AM');
		var eBigAMPM = ((mydate.getUTCHours() > 11) ? 'P': 'A');
		var eFullSmallAMPM = ((mydate.getUTCHours() > 11) ? 'pm': 'am');
		var eSmallAMPM = ((mydate.getUTCHours() > 11) ? 'p': 'a')
	} else {
		var mydate = new Date(value);
		var eFullYear = mydate.getFullYear();
		var eYear = '' + mydate.getFullYear();
		eYear = eYear.substr(eYear.length - 2, 2);
		var eLongMonth = __months[mydate.getMonth()];
		var eShortMonth = __months[mydate.getMonth()].substr(0, 3);
		var eFullMonth = '0' + (mydate.getMonth() + 1);
		eFullMonth = eFullMonth.substr(eFullMonth.length - 2, 2);
		var eMonth = mydate.getMonth() + 1;
		var eLongDay = __days[mydate.getDay()];
		var eShortDay = __days[mydate.getDay()].substr(0, 3);
		var eFullDate = '0' + mydate.getDate();
		eFullDate = eFullDate.substr(eFullDate.length - 2, 2);
		var eDate = mydate.getDate();
		var eFullMilHours = '0' + mydate.getHours();
		eFullMilHours = eFullMilHours.substr(eFullMilHours.length - 2, 2);
		var eMilHours = mydate.getHours();
		var eHours = mydate.getHours();
		if (eHours > 12) eHours = eHours - 12;
		var eFullHours = '0' + eHours;
		eFullHours = eFullHours.substr(eFullHours.length - 2, 2);
		var eFullMinutes = '0' + mydate.getMinutes();
		eFullMinutes = eFullMinutes.substr(eFullMinutes.length - 2, 2);
		var eMinutes = mydate.getMinutes();
		var eFullSeconds = '0' + mydate.getSeconds();
		eFullSeconds = eFullSeconds.substr(eFullSeconds.length - 2, 2);
		var eSeconds = mydate.getSeconds();
		var eTripleMSecs = '00' + mydate.getMilliseconds();
		eTripleMSecs = eTripleMSecs.substr(eTripleMSecs.length - 3, 3);
		var eDoubleMSecs = '0' + mydate.getMilliseconds();
		eDoubleMSecs = eDoubleMSecs.substr(eDoubleMSecs.length - 2, 2);
		var eSingleMSecs = mydate.getMilliseconds();
		var eFullBigAMPM = ((mydate.getHours() > 11) ? 'PM': 'AM');
		var eBigAMPM = ((mydate.getHours() > 11) ? 'P': 'A');
		var eFullSmallAMPM = ((mydate.getHours() > 11) ? 'pm': 'am');
		var eSmallAMPM = ((mydate.getHours() > 11) ? 'p': 'a')
	}

	format = format.replace(/YYYY/g, 'qBBBBp');
	format = format.replace(/YY/g, 'qBBp');
	format = format.replace(/MMMM/g, 'qCCCCp');
	format = format.replace(/MMM/g, 'qCCCp');
	format = format.replace(/MM/g, 'qCCp');
	format = format.replace(/M/g, 'qCp');
	format = format.replace(/DDDD/g, 'qEEEEp');
	format = format.replace(/DDD/g, 'qEEEp');
	format = format.replace(/DD/g, 'qEEp');
	format = format.replace(/D/g, 'qEp');
	format = format.replace(/HH/g, 'qFFp');
	format = format.replace(/H/g, 'qFp');
	format = format.replace(/hh/g, 'qGGp');
	format = format.replace(/h/g, 'qGp');
	format = format.replace(/NN/g, 'qIIp');
	format = format.replace(/N/g, 'qIp');
	format = format.replace(/SS/g, 'qJJp');
	format = format.replace(/S/g, 'qJp');
	format = format.replace(/ZZZ/g, 'qKKKp');
	format = format.replace(/ZZ/g, 'qKKp');
	format = format.replace(/Z/g, 'qKp');
	format = format.replace(/AA/g, 'qLLp');
	format = format.replace(/A/g, 'qLp');
	format = format.replace(/aa/g, 'qOOp');
	format = format.replace(/a/g, 'qOp');
	format = format.replace(/qBBBBp/g, eFullYear);
	format = format.replace(/qBBp/g, eYear);
	format = format.replace(/qCCCCp/g, eLongMonth);
	format = format.replace(/qCCCp/g, eShortMonth);
	format = format.replace(/qCCp/g, eFullMonth);
	format = format.replace(/qCp/g, eMonth);
	format = format.replace(/qEEEEp/g, eLongDay);
	format = format.replace(/qEEEp/g, eShortDay);
	format = format.replace(/qEEp/g, eFullDate);
	format = format.replace(/qEp/g, eDate);
	format = format.replace(/qFFp/g, eFullMilHours);
	format = format.replace(/qFp/g, eMilHours);
	format = format.replace(/qGGp/g, eFullHours);
	format = format.replace(/qGp/g, eHours);
	format = format.replace(/qIIp/g, eFullMinutes);
	format = format.replace(/qIp/g, eMinutes);
	format = format.replace(/qJJp/g, eFullSeconds);
	format = format.replace(/qJp/g, eSeconds);
	format = format.replace(/qKKKp/g, eTripleMSecs);
	format = format.replace(/qKKp/g, eDoubleMSecs);
	format = format.replace(/qKp/g, eSingleMSecs);
	format = format.replace(/qLLp/g, eFullBigAMPM);
	format = format.replace(/qLp/g, eBigAMPM);
	format = format.replace(/qOOp/g, eFullSmallAMPM);
	format = format.replace(/qOp/g, eSmallAMPM);
	return format
}